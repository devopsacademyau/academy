on:
  pull_request
  # on: 
  # schedule:
  # - cron: "0 1 * * 1,5"
    
name: Dashboard Generation
jobs:
  dashboard:
    runs-on: ubuntu-20.04
    steps:
    - uses: actions/checkout@v1

    - name: Update Dashboard Sheet
      run: make dashboard
      env:
        GOOGLE_KEY: ${{ secrets.DASHBOARD_GOOGLE_KEY }}
        SHEET_KEY: ${{ secrets.DASHBOARD_SHEET_KEY }}
        WKS_NAME: "Dashboard"
        GH_USER: ${{ secrets.DASHBOARD_GH_USER }}
        GH_TOKEN: ${{ secrets.DASHBOARD_GH_TOKEN }}
    - name: Slack notification
      env:
        SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
      uses: cemkiy/action-slacker@master
      with:
        # requirements fields for slack
        channel: '#automation-test'
        icon_url: 'slack user icon url'
        username: 'slack username'
        # author_name: 'DevOpsAcademyBot'
        title: '*Lab Progression Update*'
        text: 'To infinity and beyond!'
        image_url: 'http://my-website.com/path/to/image.jpg'
        footer: 'Slack API'
        footer_icon: 'https://platform.slack-edge.com/img/default_application_icon.png'
